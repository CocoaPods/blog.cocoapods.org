<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
      <title>Repairing Our Broken Specs Repository - CocoaPods Blog</title>
    

    <meta name="description" content="The blog for CocoaPods.org an Objective-C dependency manager">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" type="application/rss+xml" title="CocoaPods Blog" href="/feed.xml">

    <meta charset="utf-8" /><meta content="documenation cocoapods objective-c package manager" name="keywords" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="" name="description" /><meta content="" name="author" />
    <link rel="shortcut icon" href="http://cocoapods.org/favicons/favicon.ico" type="image/x-icon" /><link rel="apple-touch-icon" href="http://cocoapods.org/favicons/apple-touch-icon.png" /><link rel="apple-touch-icon" sizes="57x57" href="http://cocoapods.org/favicons/apple-touch-icon-57x57.png" /><link rel="apple-touch-icon" sizes="60x60" href="http://cocoapods.org/favicons/apple-touch-icon-60x60.png" /><link rel="apple-touch-icon" sizes="72x72" href="http://cocoapods.org/favicons/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon" sizes="76x76" href="http://cocoapods.org/favicons/apple-touch-icon-76x76.png" /><link rel="apple-touch-icon" sizes="114x114" href="http://cocoapods.org/favicons/apple-touch-icon-114x114.png" /><link rel="apple-touch-icon" sizes="120x120" href="http://cocoapods.org/favicons/apple-touch-icon-120x120.png" /><link rel="apple-touch-icon" sizes="144x144" href="http://cocoapods.org/favicons/apple-touch-icon-144x144.png" /><link rel="apple-touch-icon" sizes="152x152" href="http://cocoapods.org/favicons/apple-touch-icon-152x152.png" />

    <link rel="stylesheet" href="/assets/bootstrap-87270f5e5c31201f334e98fd5ca08aba.css">
    <link rel="stylesheet" href="/assets/main-58bc9449ddb3649691a8576c23802e70.css">
    <link rel="stylesheet" href="/assets/blog-8f214bfea084e893247d2774fb9ab604.css">


    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-29866548-3', 'cocoapods.org');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <nav class="navbar navbar-static-top" role="navigation"><section class="container"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-header-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="glyphicon-plus"></span></button><a class="navbar-brand" href="http://cocoapods.org"></a></div><div class="collapse navbar-collapse navbar-header-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="http://cocoapods.org/about">About</a></li><li><a href="http://guides.cocoapods.org">Guides</a></li><li class="active"><a href="http://blog.cocoapods.org">Blog</a></li></ul></div></section></nav>

    <section class="container">
  <article class="row">
  <header class="col-md-8 col-md-offset-2 headline blog-post">
    
      <h1>Repairing Our Broken Specs Repository</h1>
    
    
  </header>
  </article>
</section>

<section id="content-wrapper" class="post">
  <section class="container">
    <article class="row">
      <article class="author metadata col-md-2 col-md-push-10">
        <header>
          
            
              <img class="gravatar large" src="http://gravatar.com/avatar/d200a17dd269fd4001bacb11662dab4b?s=144" height=72 width=72>
            
            
              
                <p><a href="http://twitter.com/kylefuller">Kyle Fuller</a></p>
              
            
             <p>30 January 2014</p>

            
              <a href="https://twitter.com/kylefuller" class="twitter-follow-button" data-show-count="false" data-lang="en">
                Follow @kylefuller
              </a>
            
        </header>
      </article>
    
      <article class="content col-md-8">
        <p>Unfortunately we&#39;ve encountered a bug in libgit2 and we are going to have to
<strong>force push</strong> into <a href="https://github.com/CocoaPods/Specs">the Specs repository</a>. (Also known as the
‘master’ spec repo.)</p>

<h3>What does this mean for you?</h3>

<p>Well, basically your CocoaPods setup <strong>is going to break</strong>. You are going to
have to manually delete <em>any</em> local copies of the Specs repository and re-clone
the new version of the Specs repository. You can do that with the following
commands:</p>

<pre class='highlight'><code>
    $ sudo rm -fr ~/.cocoapods/repos/master
    $ pod setup
    
</code></pre>

<p><em><strong>NOTE 1:</strong> If you have any local commits or changes to the Specs repository
which are not merged, you should ensure you have a copy of them. I would
recommend that you manually copy these changes over and re-commit them. You can
fix your repository without deleting, however, this is not a simple process, so
we are instead recommending that you delete your copy of the Specs repository
and any forks of it.</em></p>

<p><em><strong>NOTE 2:</strong> In case you are storing private podspecs in your clone of the
Specs repository or you have a private spec repo that was forked from the
Specs repository, this is a great time to clean that up by using private spec
repositories <a href="http://guides.cocoapods.org/making/private-cocoapods.html">The Proper Way</a>. This way your private spec
repository should never be affected by issues in other spec repositories.</em></p>

<!-- more -->

<p><em>If you really know what you’re doing and don’t want to re-download the
complete repo, follow <a href="https://github.com/CocoaPods/Specs/issues/7029#issuecomment-33708256">these</a> instructions.</em></p>

<h3>Why did this break?</h3>

<p>The Specs repository has unfortunately broken due to <a href="https://github.com/libgit2/libgit2/pull/2085">a bug in
libgit2</a> which powers <a href="https://help.github.com/articles/creating-and-editing-files-in-your-repository">GitHub&#39;s web editor</a>. This
has <a href="https://github.com/CocoaPods/Specs/issues/7029#issuecomment-33429321">caused our git repository to become corrupt</a>:</p>

<blockquote>
<p>As fsck noted, it has duplicate entries, which is a violation of Git&#39;s object
format. GitHub check objects as they are pushed into each fork; anyone who
has built on top of the broken tree will have their push rejected, as they
are trying to bring the broken object into their fork (as a result of it
being reachable from their new commits).</p>

<p>We are looking into how this broken object got into the repository in the
first place. At this point it looks like a web-edit […], that was then merged
on the site via a pull request ([…] it looks like a bug in GitHub rather than
any kind of user error). We&#39;re looking both into fixing the bug, but also
into giving better protection to broken objects entering the repository (i.e.
this is the exact sort of problem that the fsck-on-push checks are there to
prevent, but they do not currently extend to web edits).</p>
</blockquote>

<p>The only solution is to rewrite the history of the repository and force push
the rewritten tree. Rolling out this fix basically means that all copies of the
repository have to be reset. This can be a delicate process, so deleting and
re-cloning is the safest and simplest way to do so.</p>

<h3>Will this happen again?</h3>

<p>There is a <a href="https://github.com/libgit2/libgit2/pull/2085">fix</a> in the works to fix the bug in libgit2. This
fixes a bug which would prevent libgit2 from corrupting a repository in this
particular case.</p>

<p>GitHub are also working on putting checking measures in-place on the
web-editor so that it wouldn&#39;t be possible to save a corrupt repository, and to
prevent any similar problems in the future. (As is already the case when using
<a href="https://www.kernel.org/pub/software/scm/git/docs/git-push.html">git-push</a>, which runs <a href="https://www.kernel.org/pub/software/scm/git/docs/git-fsck.html">git-fsck</a> on GitHub’s end.)</p>

<h3>Acknowledgements</h3>

<p>We would like to thoroughly thank the following people for their help in both
investigating and resolving this matter. It is very much appreciated by all of
us at CocoaPods HQ and shows the power of a (larger) community of people coming
together.</p>

<ul>
<li>Jeff King (<a href="https://github.com/peff">@peff</a>)</li>
<li>Roberto Tyley (<a href="https://github.com/rtyley">@rtyley</a>)</li>
<li>Abizer Nasir (<a href="https://github.com/Abizern">@Abizern</a>)</li>
</ul>

<p>We are very sorry for <em>all</em> time this issue takes away from our great early
adopters and pod providers. We are very thankful for your patience and
understanding while we work towards a smoothly functioning version 1 of
CocoaPods and its architecture.</p>

<p><strong>&lt;3</strong></p>

<p>– <a href="https://twitter.com/kylefuller">@kylefuller</a>,
<a href="https://twitter.com/SmileyKeith">@SmileyKeith</a>, and
<a href="https://twitter.com/alloy">@alloy</a></p>

      </article>
    </article>
  </section>
</section>

<section id="post-accessories"><section class="container"><div class="row"><article class="content col-md-8 col-md-offset-2"><a data-container="body" data-content="CocoaPods is an open source project. Help us improve these blog posts by sending a pull request. ❤" data-original-title="" data-placement="top" data-toggle="popover" data-trigger="hover" href="https://github.com/CocoaPods/blog.cocoapods.org/tree/master/_posts/2014-01-30-Repairing-Our-Broken-Specs-Repository.markdown" id="pull-request" title=""></a><a data-container="body" data-content="Check our out post archives." data-original-title="" data-placement="top" data-toggle="popover" data-trigger="hover" href="/archives" id="archives" title=""></a></article></div></section></section>

<section class="container" id="post-info"><div class="row"><article class="content .col-6 col-sm-6 col-md-4 col-md-offset-2 next "><a href="/Cocoa-Kucha-3-Berlin" title="Cocoa Kucha 3 - Berlin - 22nd Jan 2014"><header><h4>Previous Post</h4></header><h3>Cocoa Kucha 3 - Berlin - 22nd Jan 2014</h3><p>By Orta Therox</p><a class="chevron_placeholder back" href="/Cocoa-Kucha-3-Berlin"></a></a></article><article class="content col-6 col-sm-6 col-md-4 previous"><a href="/The-Kommittee-NYC" title="Cocoa Komittee - NYC"><header><h4>Next Post</h4></header><h3>Cocoa Komittee - NYC</h3><p>By Orta Therox</p><a class="chevron_placeholder next" href="/The-Kommittee-NYC"></a></a></article></div></section>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>



    <footer class="page-footer"><section class="container"><div class="row"><article class="col-md-8 col-lg-8 col-sm-12 col-md-offset-2 col-lg-offset-2 col-xs-12"><h4>CocoaPods is a project from </h4><p class="contributors"><a href="https://twitter.com/alloy">Eloy Durán</a>, <a href="https://twitter.com/fabiopelosin">Fabio Pelosin</a>, <a href="http://orta.github.io">Orta Therox</a>, and <a href="http://cocoapods.org/about">The CocoaPods Dev Team</a> with contributions from <a href="https://github.com/CocoaPods/Specs/graphs/contributors">many, many others</a>.</p><h4>Lovingly sponsored by </h4><p class="sponsors"><a href="http://artsy.net">Artsy</a>,&nbsp;<a href="http://www.fngtps.com">Fingertips</a>, <a href="https://www.heroku.com">Heroku</a>, <a href="http://www.rubymotion.com">RubyMotion</a>, <a href="https://www.sauspiel.de">Sauspiel</a>, <a href="https://www.soundcloud.com">SoundCloud</a>, and <a href="http://www.technologyastronauts.ch">Technology&nbsp;Astronauts</a>.</p></article><article class="col-md-8 col-md-offset-2 minor"></article></div></section></footer><footer class="footer-links"><section class="container"><div class="row"><article class="col-md-8 col-lg-8 col-sm-12 col-md-offset-2 col-lg-offset-2 col-xs-12"><a class="cocoapods-small-logo" href="http://cocoapods.org"></a><ul><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://guides.cocoapods.org/using/troubleshooting.html">Support</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://github.com/CocoaPods/CocoaPods">Github Repo</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://github.com/CocoaPods/Specs">Podspecs Repo</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://twitter.com/CocoaPods">@CocoaPods</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://groups.google.com/group/cocoapods">Mailing List</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://cocoapods.org/about"><span class="visible-lg-span">CocoaPods</span> Dev Team</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://guides.cocoapods.org/syntax/podfile.html">Podfile Doc<span class="hidden-lg-span">s</span><span class="visible-lg-span">umentation</span></a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://cocoapods.org/legal">Legal / Conduct</a></li></ul></article></div></section></footer>
    <script src="/assets/blog-dceaff1298175a761feee48796373314.js"></script>

    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

  </body>
</html>
