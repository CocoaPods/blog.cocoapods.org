<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
      <title>CocoaPods Stats - CocoaPods Blog</title>
    

    <meta name="description" content="The blog for CocoaPods.org the Cocoa Dependency Manager">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" type="application/rss+xml" title="CocoaPods Blog" href="/feed.xml">

    <meta charset="utf-8" /><meta content="cocoapods objective-c objc swift package manager libraries documentation search pods podspec podfile cocoa apple ios library" name="keywords" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="The Dependency Manager for iOS &amp; Mac projects" name="description" /><meta content="CocoaPods Dev Team" name="author" /><meta content="summary" name="twitter:card" /><meta content="@CocoaPods" name="twitter:site" /><meta content="@CocoaPods" name="twitter:creator" /><meta content="CocoaPods.org" name="twitter:title" /><meta content="The Dependency Manager for iOS &amp; Mac projects." name="twitter:description" /><meta content="https://www.cocoapods.org/" name="twitter:url" />
    <link rel="shortcut icon" href="https://cocoapods.org/favicons/favicon.ico" type="image/x-icon" /><link rel="apple-touch-icon" href="https://cocoapods.org/favicons/apple-touch-icon.png" /><link rel="apple-touch-icon" sizes="57x57" href="https://cocoapods.org/favicons/apple-touch-icon-57x57.png" /><link rel="apple-touch-icon" sizes="60x60" href="https://cocoapods.org/favicons/apple-touch-icon-60x60.png" /><link rel="apple-touch-icon" sizes="72x72" href="https://cocoapods.org/favicons/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon" sizes="76x76" href="https://cocoapods.org/favicons/apple-touch-icon-76x76.png" /><link rel="apple-touch-icon" sizes="114x114" href="https://cocoapods.org/favicons/apple-touch-icon-114x114.png" /><link rel="apple-touch-icon" sizes="120x120" href="https://cocoapods.org/favicons/apple-touch-icon-120x120.png" /><link rel="apple-touch-icon" sizes="144x144" href="https://cocoapods.org/favicons/apple-touch-icon-144x144.png" /><link rel="apple-touch-icon" sizes="152x152" href="https://cocoapods.org/favicons/apple-touch-icon-152x152.png" />

    <link rel="stylesheet" href="/assets/bootstrap-3b61caa441fab92578453d6681fbf963.css">
    <link rel="stylesheet" href="/assets/main-df7f28d697ab31d8aa461b8f8ff0c7e4.css">
    <link rel="stylesheet" href="/assets/blog-a6cba0ad1ceb964c9a5a5387e033c3ff.css">


    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-29866548-3', 'cocoapods.org');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <nav class="navbar navbar-static-top" role="navigation"><section class="container"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-header-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="glyphicon glyphicon-plus"></span></button><a class="navbar-brand" href="https://cocoapods.org"></a></div><div class="collapse navbar-collapse navbar-header-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="https://cocoapods.org/app">App</a></li><li><a href="https://cocoapods.org/about">About</a></li><li><a href="https://guides.cocoapods.org">Guides</a></li><li class="active"><a href="https://blog.cocoapods.org">Blog</a></li></ul></div></section></nav>

    <div id ="">
<section class="container" >
  <article class="row">
  <header class="col-md-8 col-md-offset-2 headline blog-post">
    
      <h1>CocoaPods Stats</h1>
    
    
  </header>
  </article>
</section>
</div>

<section id="content-wrapper" class="post">
  <section class="container">
    <article class="row">
      <article class="author metadata col-md-2 col-md-push-10">
        <header>
          
            
              <img class="gravatar large" src="http://gravatar.com/avatar/f116cb3be23153ec08b94e8bd4dbcfeb?s=144" height=72 width=72>
            
            
              
                <p><a href="http://twitter.com/orta">Orta Therox</a></p>
              
            
             <p>24 June 2015</p>

            
              <a href="https://twitter.com/orta" class="twitter-follow-button" data-show-count="false" data-lang="en">
                Follow @orta
              </a>
            
        </header>
      </article>
    
      <article class="content col-md-8">
        <p>People have been asking for years about feedback on how many downloads their libraries have. We&#39;ve been thinking about the problem for a about as long too, and finally ended up asking <a href="http://segment.com">Segment</a> if they would provide a backend for the project.</p>

<!-- more -->

<h3 id="but-wait,-there&#39;s-more...">But wait, there&#39;s more...</h3>

<p>It wasn&#39;t just enough to offer just download counts. We spend a lot of time working around Xcode&#39;s project file intricacies, however in this context, it provides us with foundations for a really nice feature. CocoaPods Stats will be able to keep track of the unique number of installs within Apps / Watch Apps / Extensions / Unit Tests.</p>

<p>This means is that developers using continuous integration only register as 1 install, even if the server runs <code>pod install</code> each time, separating total installations vs actual downloads.</p>

<p></article>
</div>
</section>
<div style="background-color:white;">
<section class="container"><div class="row" style="padding-bottom:0px;"><article class="content col-md-10 col-md-offset-1"><center>
<a href='https://cocoapods.org/pods/ORStackView'><img  width="1024" src='/assets/blog_img/stats/stack.png'></a></center></article>
</div>
</section>
</div>
<section class="container">
<div class="row"><article class="content col-md-8 col-md-offset-2"></p>

<h3 id="alright,-hold-up">Alright, hold up</h3>

<p>Let&#39;s go over how we check which pods get sent up for analytics, and how we do the unique installs. <a href="https://github.com/cocoapods/cocoapods-stats">CocoaPods-Stats</a> is a plugin that is now bundled with CocoaPods from version 0.38 onwards. It <a href="https://github.com/CocoaPods/cocoapods-stats/blob/0361f29ae37e82ccf385319bba9cf31464049144/lib/cocoapods_plugin.rb#L6">registers</a> as a post-install plugin and is ran on every <code>pod install</code> or <code>pod update</code>.</p>

<h4 id="detecting-public-pods">Detecting Public Pods</h4>

<p>We&#39;re very pessimistic about sending a Pod up to our <a href="https://github.com/cocoapods/stats.cocoapods.org">stats server</a>. We ensure that you have a CocoaPods/Specs repo set up as your master repo, then ensure that each pod to be sent  is inside that repo before accepting it as a public domain pod.</p>

<h4 id="data-being-sent">Data being sent</h4>

<p>First up, we don&#39;t want to know anything about your app. So in order to know unique targets we use your project&#39;s target <a href="https://github.com/artsy/eigen/blob/aea7af93daffb716ccee9aa50ce599dc7949c42b/Artsy.xcodeproj/project.pbxproj#L3888">UUID</a> as an identifier. These are a <a href="http://danwright.info/blog/2010/10/xcode-pbxproject-files-3/">hash</a> of your MAC address, Xcode&#39;s process id and the time of target creation (but we only know the UUID/hash, so your MAC address is unknown to us). These UUIDs never change in a project&#39;s lifetime (contrary to, for example, the bundle identifier). We double hash it just to be super safe.</p>
<div class="highlight">      </article>
      </article>
      </section>
      
      <div style="background-color:white;">
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
<pre class='highlight'><code class="ruby language-ruby" data-lang="ruby">  <span class="c1"># Grab the project and the type of target</span>
  <span class="n">uuid</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">user_target_uuids</span><span class="o">.</span><span class="n">first</span>
  <span class="n">project_target</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">objects_by_uuid</span><span class="o">[</span><span class="n">uuid</span><span class="o">]</span>

  <span class="c1"># Send in a digested&#39;d UUID anyway, a second layer</span>
  <span class="c1"># of misdirection can&#39;t hurt</span>
  <span class="p">{</span>
    <span class="ss">:uuid</span> <span class="o">=&gt;</span> <span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">uuid</span><span class="p">),</span>
    <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="n">project_target</span><span class="o">.</span><span class="n">product_type</span><span class="p">,</span>
    <span class="ss">:pods</span> <span class="o">=&gt;</span> <span class="n">pods</span>
  <span class="p">}</span>
</code></pre>      </article>
      </article>
      </section>
      </div>
      
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
</div>
<p>We then also send along the CocoaPods version that was used to generate this installation. Ideally before release we&#39;ll also be able to give statistics on how many people are using <code>pod try [pod]</code> for your library too.</p>

<h4 id="how-does-it-work?">How does it work?</h4>

<p>My first attempt at a stats architecture was based on how <a href="https://github.com/npm/download-counts#data-source">npm does stats</a>, roughly speaking they send all logs to S3 where they are map-reduced on a daily basis into individual package metrics. This is an elegant solution for a <a href="https://www.crunchbase.com/organization/npm">company</a> with people working full time on up-time and stability. As someone who wants to be building iOS apps, and not maintaining <a href="http://cocoadocs.org/readme/">more</a> infrastructure in my spare time, I wanted to avoid this.</p>

<p>We use Segment in Artsy, and our analytics team had really good things to say about their <a href="https://segment.com/redshift">Redshift</a> infrastructure. So I reached out about having them hosting the stats infrastructure for CocoaPods. They offered a lot of great advice around the data-modelling, we were up and running really quickly. So you already know about the CocoaPods plugin, but from there it sends your anonymous Pod stats up to <a href="https://github.com/cocoapods/stats.cocoapods.org">stats.cocoapods.org</a>. This acts as a <a href="https://github.com/CocoaPods/stats.cocoapods.org/blob/b1889c9b35faef524685d99898be9ac8447ed7f8/spec/functional/api/v1/install_spec.rb">conduit</a> sending analytics events to Segment. A <a href="https://github.com/CocoaPods/stats.cocoapods.org/blob/b1889c9b35faef524685d99898be9ac8447ed7f8/Rakefile#L49">daily task</a> is triggered on the web site, this makes <a href="https://github.com/CocoaPods/stats.cocoapods.org/blob/b1889c9b35faef524685d99898be9ac8447ed7f8/runner/stats_coordinator.rb">SQL requests</a> against the Redshift instance which is then imported into <a href="http://metrics.cocoapods.org/api/v1/pods/Expecta">metrics.cocoapods.org</a>.</p>

<h2 id="faq">FAQ</h2>

<h4 id="can-i-opt-out-as-a-cocoapods-user?">Can I opt out as a CocoaPods user?</h4>

<p>Sure. You can set an <a href="http://apple.stackexchange.com/questions/106778/how-do-i-set-environment-variables-on-os-x">environment variable</a> <code>COCOAPODS_DISABLE_STATS</code> to true in your shell, and stats will not be sent from your machine.</p>

<h4 id="does-this-affect-every-pod?">Does this affect every pod?</h4>

<p>Yeah, every pod will get download stats.</p>

<h4 id="will-it-be-live-stats?">Will it be live stats?</h4>

<p>No, they get generated once per day.</p>

<h4 id="what-is-the-rollout-strategy?">What is the rollout strategy?</h4>

<p>We plan on making this initially a separate CocoaPods plugin that you can optionally install via <code>[sudo] gem install cocoapods-stats</code> which will send the data. In a release or two we will bundle this into CocoaPods, and it will be installed by default for everyone moving forwards.</p>

<h4 id="can-i-use-it-right-now?">Can I use it right now?</h4>

<p>Sure, update to the latest CocoaPods <code>[sudo] gem install cocoapods</code> or download the latest <a href="https://github.com/CocoaPods/CocoaPods-app">CocoaPods.app</a>.</p>

<h4 id="can-i-use-this-to-find-out-how-many-people-are-using-an-older-build-of-my-pods?">Can I use this to find out how many people are using an older build of my pods?</h4>

<p>Not automatically, we&#39;ve not figured out a strategy for doing this yet, but you can email <a href="mailto:orta@cocoapods.org">orta@cocoapods.org</a> for one off requests once it&#39;s up and running. Ideally once this has settled I&#39;d like to take a look at making a stats overview page per pod, but that has some tricky technicalities.</p>

<h4 id="how-does-this-affect-the-quality-indexes-/-sorting?">How does this affect the quality indexes / sorting?</h4>

<p>Ideally we can reduce the amount of impact GitHub stars affects a quality index, and replace some of the values with new metrics based on downloads/installations. </p>

<h4 id="what-commands-does-this-run-on?">What commands does this run on?</h4>

<p>It runs at the end of a <code>pod install</code> or a <code>pod update</code>.</p>

<h4 id="i-check-in-my-pods-directory,-how-does-this-affect-stats-for-the-pods-i-use?">I check in my Pods directory, how does this affect stats for the pods I use?</h4>

<p>Checking in your Pods directory will mean that the download count for the pods used will rarely be affected, but the installations will be the exact same. They only register once per project, so multiple developers on the same project running <code>pod install</code> will not raise this number.</p>

      </article>
    </article>
  </section>
</section>

<section id="post-accessories"><section class="container"><div class="row"><article class="content col-md-8 col-md-offset-2"><a data-container="body" data-content="CocoaPods is an open source project. Help us improve these blog posts by sending a pull request. â¤" data-original-title="" data-placement="top" data-toggle="popover" data-trigger="hover" href="https://github.com/CocoaPods/blog.cocoapods.org/tree/master/_posts/2015-06-24-Stats.markdown" id="pull-request" title=""></a><a data-container="body" data-content="Check our out post archives." data-original-title="" data-placement="top" data-toggle="popover" data-trigger="hover" href="/archives" id="archives" title=""></a><div class="author-info"><img class="gravatar large" src="//gravatar.com/avatar/f116cb3be23153ec08b94e8bd4dbcfeb" /><a class="twitter-follow-button" data-dnt="true" data-show-count="false" href="https://twitter.com/orta">Follow orta</a></div></article></div></section></section>

<section class="container" id="post-info"><div class="row"><article class="content .col-6 col-sm-6 col-md-4 col-md-offset-2 next "><a href="/CocoaPods.org-Two-point-Five" title="CocoaPods.org v2.5"><header><h4>Previous Post</h4></header><h3>CocoaPods.org v2.5</h3><p>By Orta Therox</p><a class="chevron_placeholder back" href="/CocoaPods.org-Two-point-Five"></a></a></article><article class="content col-6 col-sm-6 col-md-4 previous"><a href="/CocoaPods-0.38" title="CocoaPods 0.38 - watchOS and target de-duplication"><header><h4>Next Post</h4></header><h3>CocoaPods 0.38 - watchOS and target de-duplication</h3><p>By Marius Rackwitz</p><a class="chevron_placeholder next" href="/CocoaPods-0.38"></a></a></article></div></section>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>



    <footer class="page-footer"><section class="container"><div class="row"><article class="col-md-8 col-lg-8 col-sm-12 col-md-offset-2 col-lg-offset-2 col-xs-12"><h4>CocoaPods is a project from</h4><p class="contributors"> <a href="https://twitter.com/dnkoutso">Dimitris Koutsogiorgas</a>, <a href="http://dantoml.com">Danielle Tomlinson</a>, <a href="http://orta.io">Orta Therox</a>, <a href="https://github.com/paulb777">Paul Beusterien</a>, <a href="http://segiddins.me">Samuel Giddins</a>, and <a href="https://cocoapods.org/about#team">The CocoaPods Dev Team</a> with contributions from <a href="https://github.com/CocoaPods/Specs/graphs/contributors">many, many others</a>.</p><h4>Lovingly sponsored by</h4><p class="sponsors"><a href="http://artsy.net">Artsy</a>, <a href="http://www.usebutton.com">Button</a>, <a href="http://www.capitalone.io">Capital One</a>, <a href="https://circleci.com">CircleCI</a>, <a href="http://discontinuity.eu">Discontinuity</a>, <a href="http://www.fngtps.com">Fingertips</a>, <a href="https://developers.google.com">Google</a>, <a href="https://www.heroku.com">Heroku</a>, <a href="https://realm.io">Realm</a>, <a href="http://www.rubymotion.com">RubyMotion</a>, <a href="https://www.sauspiel.de">Sauspiel</a>, <a href="https://www.slack.com">Slack</a>, <a href="https://www.soundcloud.com">SoundCloud</a>, <a href="https://www.stripe.com">Stripe</a>, <a href="https://www.squareup.com">Square</a>, and  <a href="http://www.technologyastronauts.ch">Technology&nbsp;Astronauts</a>.</p></article></div></section></footer><footer class="footer-links"><section class="container"><div class="row"><article class="col-md-8 col-lg-8 col-sm-12 col-md-offset-2 col-lg-offset-2 col-xs-12"><a class="cocoapods-small-logo" href="https://cocoapods.org"></a><ul><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://guides.cocoapods.org/using/troubleshooting.html">Support</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://github.com/CocoaPods/CocoaPods">GitHub Repo</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://status.cocoapods.org">Web Properties Status</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://twitter.com/CocoaPods">@CocoaPods</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://groups.google.com/group/cocoapods">Mailing List</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://cocoapods.org/about"><span class="visible-lg-span">CocoaPods</span> Dev Team</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://guides.cocoapods.org/syntax/podfile.html">Podfile Doc<span class="hidden-lg-span">s</span><span class="visible-lg-span">umentation</span></a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://cocoapods.org/legal">Legal / Conduct</a></li></ul></article></div></section></footer>
    <script src="/assets/blog-c2911afb0e1e77d79b486c5c39fe0cc6.js"></script>

    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

  </body>
</html>
