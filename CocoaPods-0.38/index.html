<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
      <title>CocoaPods 0.38 - watchOS and target de-duplication - CocoaPods Blog</title>
    

    <meta name="description" content="The blog for CocoaPods.org the Cocoa Dependency Manager">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" type="application/rss+xml" title="CocoaPods Blog" href="/feed.xml">

    <meta charset="utf-8" /><meta content="cocoapods objective-c objc swift package manager libraries documentation search pods podspec podfile cocoa apple ios library" name="keywords" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="The Dependency Manager for iOS &amp; Mac projects" name="description" /><meta content="CocoaPods Dev Team" name="author" /><meta content="summary" name="twitter:card" /><meta content="@CocoaPods" name="twitter:site" /><meta content="@CocoaPods" name="twitter:creator" /><meta content="CocoaPods.org" name="twitter:title" /><meta content="The Dependency Manager for iOS &amp; Mac projects." name="twitter:description" /><meta content="https://www.cocoapods.org/" name="twitter:url" />
    <link rel="shortcut icon" href="https://cocoapods.org/favicons/favicon.ico" type="image/x-icon" /><link rel="apple-touch-icon" href="https://cocoapods.org/favicons/apple-touch-icon.png" /><link rel="apple-touch-icon" sizes="57x57" href="https://cocoapods.org/favicons/apple-touch-icon-57x57.png" /><link rel="apple-touch-icon" sizes="60x60" href="https://cocoapods.org/favicons/apple-touch-icon-60x60.png" /><link rel="apple-touch-icon" sizes="72x72" href="https://cocoapods.org/favicons/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon" sizes="76x76" href="https://cocoapods.org/favicons/apple-touch-icon-76x76.png" /><link rel="apple-touch-icon" sizes="114x114" href="https://cocoapods.org/favicons/apple-touch-icon-114x114.png" /><link rel="apple-touch-icon" sizes="120x120" href="https://cocoapods.org/favicons/apple-touch-icon-120x120.png" /><link rel="apple-touch-icon" sizes="144x144" href="https://cocoapods.org/favicons/apple-touch-icon-144x144.png" /><link rel="apple-touch-icon" sizes="152x152" href="https://cocoapods.org/favicons/apple-touch-icon-152x152.png" />

    <link rel="stylesheet" href="/assets/bootstrap-3b61caa441fab92578453d6681fbf963.css">
    <link rel="stylesheet" href="/assets/main-df7f28d697ab31d8aa461b8f8ff0c7e4.css">
    <link rel="stylesheet" href="/assets/blog-a6cba0ad1ceb964c9a5a5387e033c3ff.css">


    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-29866548-3', 'cocoapods.org');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <nav class="navbar navbar-static-top" role="navigation"><section class="container"><div class="navbar-header"><button class="navbar-toggle" data-target=".navbar-header-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="glyphicon glyphicon-plus"></span></button><a class="navbar-brand" href="https://cocoapods.org"></a></div><div class="collapse navbar-collapse navbar-header-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="https://cocoapods.org/app">App</a></li><li><a href="https://cocoapods.org/about">About</a></li><li><a href="https://guides.cocoapods.org">Guides</a></li><li class="active"><a href="https://blog.cocoapods.org">Blog</a></li></ul></div></section></nav>

    <div id ="">
<section class="container" >
  <article class="row">
  <header class="col-md-8 col-md-offset-2 headline blog-post">
    
      <h1>CocoaPods 0.38 - watchOS and target de-duplication</h1>
    
    
  </header>
  </article>
</section>
</div>

<section id="content-wrapper" class="post">
  <section class="container">
    <article class="row">
      <article class="author metadata col-md-2 col-md-push-10">
        <header>
          
            
              <img class="gravatar large" src="http://gravatar.com/avatar/ca018f2258eadef2d02f5dcea5c25b88?s=144" height=72 width=72>
            
            
              
                <p><a href="http://twitter.com/mrackwitz">Marius Rackwitz</a></p>
              
            
             <p>21 July 2015</p>

            
              <a href="https://twitter.com/mrackwitz" class="twitter-follow-button" data-show-count="false" data-lang="en">
                Follow @mrackwitz
              </a>
            
        </header>
      </article>
    
      <article class="content col-md-8">
        <p>TL;DR: <em>CocoaPods 0.38</em> has been released, with watchOS 2 support, target de-duplication, and Stats for everyone.</p>

<!-- more -->

<p>CocoaPods 0.38 has been released.
This is our first update since WWDC and it brings support for Apple&#39;s latest releases, including Xcode 7 and watchOS.
It also includes lots of improvements that make building Pods easier.
Furthermore, it rolls out <a href="http://blog.cocoapods.org/Stats/">Stats</a> for everyone.</p>

<h3 id="watchos">watchOS</h3>

<p>The update allows you to use Pods with watchOS.
As a Pod Author, you have to specify the <a href="https://guides.cocoapods.org/syntax/podspec.html#watchos">deployment target
for watchOS</a> in the Podspec, as seen below:</p>
<div class="highlight">      </article>
      </article>
      </section>
      
      <div style="background-color:white;">
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
<pre class='highlight'><code class="ruby language-ruby" data-lang="ruby"><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="c1"># …</span>
  <span class="n">s</span><span class="o">.</span><span class="n">watchos</span><span class="o">.</span><span class="n">deployment_target</span> <span class="o">=</span> <span class="s1">&#39;2.0&#39;</span>
<span class="k">end</span>
</code></pre>      </article>
      </article>
      </section>
      </div>
      
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
</div>
<p>What this means in practice, is that not all Pods are automatically available by default.
Any Pod that can support watchOS needs to explicitly add support by adding <code>s.watchos.deployment_target</code>.
It is an entirely new platform.</p>

<h3 id="target-deduplication">Target Deduplication</h3>

<p>CocoaPods now de-duplicates Pod targets, which means that it recognises when a dependency is used multiple times across different user targets but only needs to be built once.
But sometimes this is not possible and they still need to be generated in different variants and thus build multiple times.
The targets in <code>Pods.xcodeproj</code> need to be duplicated when one of the following conditions applies:</p>

<ul>
<li>They are used on different platforms.</li>
<li>They are used with differents sets of subspecs.</li>
<li>They have any dependency which needs to be duplicated.</li>
</ul>

<p>This fixes several issues with Archiving apps with extensions, but also reduces build times significantly.</p>

<h3 id="removal-of-the-enviroment-header">Removal of the Enviroment Header</h3>

<p>After updating and running <code>pod install</code> on your integration, you will see that some header files in the Pods directory won&#39;t be generated anymore matching the pattern <code>Pods-*-environment.h</code>.
This was the environment header, which contained precompiler macro definitions with the version components of each dependency used in the integrated target.
It was visible not only for the user target, but also for all its dependencies.
It could be used to make additional features available if a given pod is present.
But this was also the cause of some issues.
One of them was that it wouldn&#39;t be possible to de-duplicate frameworks.
If you relied on that, you can still use the Clang file checking macro <a href="http://clang.llvm.org/docs/LanguageExtensions.html#include-file-checking-macros"><code>__has_include</code></a> to determine (by the presence of a header) whether a specific dependency is available or not:</p>
<div class="highlight">      </article>
      </article>
      </section>
      
      <div style="background-color:white;">
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
<pre class='highlight'><code class="objective-c language-objective-c" data-lang="objective-c"><span class="cp">#if __has_include(&lt;QueryKit/QueryKit.h&gt;)</span>
  <span class="cp">#import &lt;QueryKit/QueryKit.h&gt;</span>
<span class="cp">#endif</span>
</code></pre>      </article>
      </article>
      </section>
      </div>
      
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
</div>
<p>To make optional behavior in your Pod available, you should use <a href="https://guides.cocoapods.org/syntax/podspec.html#group_subspecs">subspecs</a>, exclude the subspec from the <code>default_subspecs</code> and declare there an explicit dependency, which is versioned and will affect the dependency resolution only when the user explicitly includes the subspec.</p>

<h3 id="breaking-change-to-the-hooks-api">Breaking Change to the Hooks-API</h3>

<p>The Podfile allows you to define <code>pre_install</code> and <code>post_install</code> hooks.
Before this update, we maintained a proxy layer, so that we could alter the installation / integration process and the model and just change how the Hooks API representations access those artifacts.
This worked for a while, but finally we became aware that we reached a point where both came completely out-of-sync.
Because of that, we relinquished that approach and made the underlying installer directly available, which was exposed before anyway and allowed more advanced possibilities for this more advanced feature.</p>

<p>If you relied on that feature, this table may help you with the mapping and give you some help how to migrate:</p>

<table><thead>
<tr>
<th style="text-align: left">InstallerRepresentation</th>
<th style="text-align: left">Installer</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left"><code>sandbox_root</code></td>
<td style="text-align: left"><code>sandbox.root</code></td>
</tr>
<tr>
<td style="text-align: left"><code>project</code></td>
<td style="text-align: left"><code>pods_project</code></td>
</tr>
<tr>
<td style="text-align: left"><code>pods</code></td>
<td style="text-align: left">~&gt; <code>pod_targets</code></td>
</tr>
<tr>
<td style="text-align: left"><code>libraries</code></td>
<td style="text-align: left">~&gt; <code>aggregate_targets</code></td>
</tr>
<tr>
<td style="text-align: left"><code>specs_by_lib</code></td>
<td style="text-align: left">use <code>#find</code> or <code>#select</code> on <code>pod_targets</code></td>
</tr>
<tr>
<td style="text-align: left"><code>pods_by_lib</code></td>
<td style="text-align: left">use <code>#find</code> or <code>#select</code> on <code>aggregate_targets</code></td>
</tr>
<tr>
<td style="text-align: left"><code>sandbox</code></td>
<td style="text-align: left"><code>sandbox</code></td>
</tr>
<tr>
<td style="text-align: left"><code>config</code></td>
<td style="text-align: left"><code>config</code></td>
</tr>
<tr>
<td style="text-align: left"><code>installer</code></td>
<td style="text-align: left">not needed</td>
</tr>
</tbody></table>

<p>See also the <a href="http://www.rubydoc.info/github/cocoapods/cocoapods/Pod/Installer">gem API documentation of the <code>Installer</code></a>.</p>

<p>If you need to keep compatibility to the older versions of CocoaPods, then you can simply check the gem version in the Podfile as it is just Ruby code after all.</p>
<div class="highlight">      </article>
      </article>
      </section>
      
      <div style="background-color:white;">
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
<pre class='highlight'><code class="ruby language-ruby" data-lang="ruby"><span class="n">post_install</span> <span class="k">do</span> <span class="o">|</span><span class="n">installer_or_rep</span><span class="o">|</span>
  <span class="c1"># @note: Remove after CocoaPods 0.38+ is completely rolled out</span>
  <span class="c1"># and rename block argument to `installer`.</span>
  <span class="n">installer</span> <span class="o">=</span> <span class="n">installer_or_rep</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="ss">:installer</span><span class="p">)</span> <span class="p">?</span> <span class="n">installer_or_rep</span><span class="o">.</span><span class="n">installer</span> <span class="p">:</span> <span class="n">installer_or_rep</span>

  <span class="c1"># You can use the installer from now on.</span>
<span class="k">end</span>
</code></pre>      </article>
      </article>
      </section>
      </div>
      
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
</div>
<h3 id="split-of-xcconfig">Split of <code>xcconfig</code></h3>

<p>One of the more advanced attribute in Podspecs is - <em>or better was</em> - the attribute <code>xcconfig</code>.</p>

<p>This allow you to specify build settings for your Pod.
Previously those were made available to libraries and the integrated target.</p>

<p>We broke this with the support for frameworks.
This wasn&#39;t an issue for most Pods because the build setting is mostly used to configure build settings which are relevant only to the generated Pod target itself.
When we mentioned that there were still some Pods which weren&#39;t working anymore as expected due to that change, we decided to split the attribute from now on.
This way Pods also can&#39;t accidentally overwrite or conflict with build settings of the user target.</p>

<p>The former attribute <code>xcconfig</code> is deprecated and will cause a linter error when pushing new versions to trunk.
The new attributes are available as <code>pod_target_xcconfig</code> and <code>user_target_xcconfig</code>, which makes their effects more clear.
The latter attribute (<code>user_target_xcconfig</code>) should be used with great care, because well designed Pods should be self-contained and make as few assumptions about their environment as possible.
Furthermore, this attribute can cause conflicts when different values are specified by two Pods for a build setting which doesn&#39;t allow multiple values and so cannot be merged.</p>

<h3 id="deterministic-uuids-by-xcodeproj">Deterministic UUIDs by Xcodeproj</h3>

<p>This update also includes the latest version of Xcodeproj, which encapsulates the API to Xcode projects.
Beside support for new build settings, it now supports the generation of deterministic UUIDs for every object in the project file.
That means in practice mostly, that you have smaller diffs for the <code>Pods.xcodeproj</code> after running <code>pod install</code> or <code>pod update</code>, which reduce unnecessary merge conflicts.
This behavior can be disabled via the new <code>COCOAPODS_DISABLE_DETERMINISTIC_UUIDS</code> environment variable.</p>

<h3 id="resolver-takes-the-deployment-target-into-account">Resolver takes the Deployment Target into account</h3>

<p>The deployment target of a podspec is now taken into account in the dependency resolution process.
This will ensure that CocoaPods will always be able to resolve your Podfile, even if newer versions of pods are released that have higher minimum deployment targets.
It makes the behavior of CocoaPods overall less surprising.</p>

<h3 id="thanks-to-contributors-of-bug-fixes">Thanks to Contributors of Bug Fixes</h3>

<p>Along with these enhancements, 0.38 features dozens of bug fixes.
Special thanks to all the new contributors we had for this release, especially for their help in squashing bugs.</p>

<h2 id="updating">Updating</h2>

<p>To install the last release of CocoaPods you can run:</p>
<div class="highlight">      </article>
      </article>
      </section>
      
      <div style="background-color:white;">
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
<pre class='highlight'><code class="bash language-bash" data-lang="bash"><span class="nv">$ </span><span class="o">[</span>sudo<span class="o">]</span> gem install cocoapods
</code></pre>      </article>
      </article>
      </section>
      </div>
      
      <section class="container">
      <article class="row">
      <article class="content col-md-8 col-md-offset-2">
</div>
<p>Until version 1.0 we strongly encourage you to keep CocoaPods up-to-date.</p>

<p>For all the details, don’t miss the
<a href="https://github.com/CocoaPods/CocoaPods/releases/tag/0.38.0">Changelog</a>!</p>

      </article>
    </article>
  </section>
</section>

<section id="post-accessories"><section class="container"><div class="row"><article class="content col-md-8 col-md-offset-2"><a data-container="body" data-content="CocoaPods is an open source project. Help us improve these blog posts by sending a pull request. ❤" data-original-title="" data-placement="top" data-toggle="popover" data-trigger="hover" href="https://github.com/CocoaPods/blog.cocoapods.org/tree/master/_posts/2015-07-21-CocoaPods-0.38.markdown" id="pull-request" title=""></a><a data-container="body" data-content="Check our out post archives." data-original-title="" data-placement="top" data-toggle="popover" data-trigger="hover" href="/archives" id="archives" title=""></a><div class="author-info"><img class="gravatar large" src="//gravatar.com/avatar/ca018f2258eadef2d02f5dcea5c25b88" /><a class="twitter-follow-button" data-dnt="true" data-show-count="false" href="https://twitter.com/mrackwitz">Follow mrackwitz</a></div></article></div></section></section>

<section class="container" id="post-info"><div class="row"><article class="content .col-6 col-sm-6 col-md-4 col-md-offset-2 next "><a href="/Stats" title="CocoaPods Stats"><header><h4>Previous Post</h4></header><h3>CocoaPods Stats</h3><p>By Orta Therox</p><a class="chevron_placeholder back" href="/Stats"></a></a></article><article class="content col-6 col-sm-6 col-md-4 previous"><a href="/Stats-Reset" title="CocoaPods Stats Resetting"><header><h4>Next Post</h4></header><h3>CocoaPods Stats Resetting</h3><p>By Orta Therox</p><a class="chevron_placeholder next" href="/Stats-Reset"></a></a></article></div></section>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>



    <footer class="page-footer"><section class="container"><div class="row"><article class="col-md-8 col-lg-8 col-sm-12 col-md-offset-2 col-lg-offset-2 col-xs-12"><h4>CocoaPods is a project from</h4><p class="contributors"> <a href="http://buegling.com">Boris Bügling</a>, <a href="http://mariusrackwitz.de">Marius Rackwitz</a>, <a href="http://orta.io">Orta Therox</a>, <a href="http://segiddins.me">Samuel Giddins</a>, and <a href="https://cocoapods.org/about#team">The CocoaPods Dev Team</a> with contributions from <a href="https://github.com/CocoaPods/Specs/graphs/contributors">many, many others</a>.</p><h4>Lovingly sponsored by</h4><p class="sponsors"><a href="http://artsy.net">Artsy</a>, <a href="http://www.usebutton.com">Button</a>, <a href="http://www.capitalone.io">Capital One</a>, <a href="http://discontinuity.eu">Discontinuity</a>, <a href="http://www.fngtps.com">Fingertips</a>, <a href="https://www.heroku.com">Heroku</a>, <a href="http://www.rubymotion.com">RubyMotion</a>, <a href="https://www.sauspiel.de">Sauspiel</a>, <a href="https://www.slack.com">Slack</a>, <a href="https://www.soundcloud.com">SoundCloud</a>, <a href="https://www.stripe.com">Stripe</a> and <a href="http://www.technologyastronauts.ch">Technology&nbsp;Astronauts</a>.</p></article></div></section></footer><footer class="footer-links"><section class="container"><div class="row"><article class="col-md-8 col-lg-8 col-sm-12 col-md-offset-2 col-lg-offset-2 col-xs-12"><a class="cocoapods-small-logo" href="https://cocoapods.org"></a><ul><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://guides.cocoapods.org/using/troubleshooting.html">Support</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://github.com/CocoaPods/CocoaPods">GitHub Repo</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://status.cocoapods.org">Web Properties Status</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://twitter.com/CocoaPods">@CocoaPods</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="http://groups.google.com/group/cocoapods">Mailing List</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://cocoapods.org/about"><span class="visible-lg-span">CocoaPods</span> Dev Team</a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://guides.cocoapods.org/syntax/podfile.html">Podfile Doc<span class="hidden-lg-span">s</span><span class="visible-lg-span">umentation</span></a></li><li class="col-md-3 col-sm-3 col-xs-6"><a href="https://cocoapods.org/legal">Legal / Conduct</a></li></ul></article></div></section></footer>
    <script src="/assets/blog-c2911afb0e1e77d79b486c5c39fe0cc6.js"></script>

    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

  </body>
</html>
